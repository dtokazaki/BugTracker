<!DOCTYPE>
<html>
<head>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script src="https://sdk.amazonaws.com/js/aws-sdk-2.7.16.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
<meta content="text/html;charset=utf-8" http-equiv="Content-Type">
<meta content="utf-8" http-equiv="encoding">
</head>
<body>
<script type="text/javascript">

function createItem() {
	var x = document.getElementById("addBug");
	
	var des = x.elements[0].value;
	var doi = x.elements[1].value;

	//if (des == "") {
	//	document.getElementById("uniqueCode").innerHTML="ERROR no description present";
	//	return;
	//}
	//if (doi == "") {
	//	doi = " ";
	//}

    var data = "description=" + des +"&details="+doi;
 	$.ajax({
		url: "https://052stnmylg.execute-api.us-west-1.amazonaws.com/firstTest/createForm",
		data: data,
		type: "GET",
		beforeSend: function(xhr) {
			xhr.setRequestHeader('x-api-key', 'NZLlovyCrO83qyPR4IXNl7ARqF9nLaFn2EZp7AlL');
		},
		success: function (data) {
			alert("Success!" + JSON.stringify(data))
			document.getElementById("uniqueCode").innerHTML= "The unique code for the bug you found is " + JSON.stringify(data);
		}

	})
	    
}

function readItem() {
	var x = document.getElementById("read");
	var id = x.elements[0].value;

	//if (id == "") {
	//	document.getElementById("bugStatusID").innerHTML="Bug ID is missing";
	//	return;
	//}
	var data = "id=" + id;
	
	$.ajax({
		url: "https://052stnmylg.execute-api.us-west-1.amazonaws.com/firstTest/getForm",
		data: data,
		type: "GET",
		beforeSend: function(xhr) {
			xhr.setRequestHeader('x-api-key', 'NZLlovyCrO83qyPR4IXNl7ARqF9nLaFn2EZp7AlL');
		},
		success: function (data) {
			alert("Success!" + JSON.stringify(data))
			document.getElementById("bugStatusID").innerHTML="Bug ID: " + data['code'];
			document.getElementById("bugStatusDescr").innerHTML = "Description: " + data['description'];
			document.getElementById("bugStatusDoing").innerHTML= "Details: " + data['details'];
			document.getElementById("bugStatusStatus").innerHTML="Status: " + data['status'];
		}//,
		//error: function(XMLHttpRequest, textStatus, errorThrown) {
		//	document.getElementById("bugStatusID").innerHTML="ERROR: ID is invalid";
		//	document.getElementById("bugStatusDescr").innerHTML= "Status: " + textStatus;
		//	document.getElementById("bugStatusDoing").innerHTML=" Error: " + errorThrown;
		//}
     })
		
}

</script>
</head>

<body>
  <a href = "table.html">
	  <button type="button" class="btn btn-default">Table</button></a>
  <a href = "dynamoForm.html">
	  <button type="button" class="btn btn-default disabled">Home</button></a>
  <div class="btn-group" role="group" aria-label="...">
	  <a href = "tester.html" class="btn btn-default">Tester</a>
	  <a href="developer.html" class="btn btn-default">Developer</a>
	  <a href="manager.html" class="btn btn-default">Manager</a>
  </div>
  <form id="addBug">
	<div class="form-group">
	<label for="description">Description of the bug:</label>
	<textarea class="form-control" id="description" rows="3" placeholder="Description" type="text"></textarea>
	</div>

	<div class="form-group">
	<label for="during">What were you doing when you encountered the bug?</label>
	<textarea class="form-control" id="during" rows="3" placeholder="What you were doing" type="text"></textarea>
	</div>

	<!-- <div>
	<label for="bugID">Input the unique code of your bug (between 0 and 5000 please).</label>
	<input type="text" class="form-control" id="bugID1" placeholder="Unique Code">
	</div> -->
	<input id="Submit1" type="button" value="Create Item" onclick="createItem();" />
</form>
<br/>
<p id="uniqueCode"></p>

<br/>
<form id="read">
  <div>
	<label for="bugID">If you already submitted this form, please input your unique code to check on the status of your bug.</label>
	<input type="text" class="form-control" id="bugID2" placeholder="Unique Code">
  </div>
  <input id="Submit2" type="button" value="Look At Item" onclick="readItem();" />

</form>

<br>
<p id = "bugStatusID"></p>
<p id = "bugStatusDescr"></p>
<p id = "bugStatusDoing"></p>
<p id = "bugStatusStatus"></p>
</body>
</html>
